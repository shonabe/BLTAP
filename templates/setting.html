{% extends "base.html" %}
{% block content %}

<div class="container my-5">

  <h1 class="mb-4 text-center fw-bold display-5 text-primary">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h1>

  <!-- ç›®æ¨™ãƒ»é€²æ—ã‚«ãƒ¼ãƒ‰ -->
  <div class="row mb-5 justify-content-center">
    <div class="col-md-8">
      <div class="card shadow-lg border-0 rounded-4 p-4 bg-light">
        <h3 class="mb-3">ğŸ¯ ä»Šæ—¥ã®æˆæœ</h3>
        <p class="lead">é›†ä¸­ã—ã¦ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ç·´ç¿’ã‚’è¡Œã„ã€å‰å›ã®ãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒ ã‚’æ›´æ–°ã—ã¾ã—ã‚‡ã†ï¼</p>
        <div class="progress" style="height: 25px;">
          <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
        </div>
        <small class="text-muted">ç›®æ¨™é”æˆã¾ã§ã‚ã¨0%</small>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-lg border-0 rounded-4 p-4 bg-light">
        <div class="d-flex align-items-center mb-3 gap-3">
          <h3 class="mb-0">ç›®æ¨™è¨­å®š</h3>
          <button id="reset-Btn" class="btn btn-success btn-sm w-50 ms-5">ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
        <div class="container mt-4">
          <div class="row">
            <div class="col-md-6">
              <label for="trainingInput" class="form-label fw-bold">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å›æ•°</label>
              <input
                type="number"
                class="form-control fs-1 text-end"
                id="training-input" 
                min="1"
                step="1"
                placeholder="1"
                style="height: 4rem;"
              >
              <button id="save-Btn" class="btn btn-primary btn-sm mt-2 w-50">æ±ºå®š</button>
              
            </div>

            <div class="col-md-6 text-center">
              <div class="fw-bold fs-1">æ®‹ã‚Š</div>
              <div id="remaining-Display" class="fw-bold fs-1 text-primary">--</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ¡ãƒ‹ãƒ¥ãƒ¼ä¸€è¦§ -->
  <div class="row g-4 justify-content-center">

    <div class="col-md-4">
      <div class="card shadow-sm rounded-4 border-0 h-100">
        <div class="card-body d-flex flex-column">
          <h4 class="card-title mb-3 text-success">ğŸŸ¢ Easyãƒ¬ãƒ™ãƒ«</h4>
          <p class="card-text flex-grow-1">ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã®åŸºç¤å›ºã‚ã«æœ€é©ã€‚ã‚†ã£ãã‚Šç¢ºå®Ÿã«æ–‡å­—ã‚’æ‰“ã¤ç·´ç¿’ãŒã§ãã¾ã™ã€‚</p>
          <a href="{{ url_for('training', problem='easy') }}" class="btn btn-success btn-lg mt-auto">ç·´ç¿’é–‹å§‹</a>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm rounded-4 border-0 h-100">
        <div class="card-body d-flex flex-column">
          <h4 class="card-title mb-3 text-primary">ğŸ”µ Normalãƒ¬ãƒ™ãƒ«</h4>
          <p class="card-text flex-grow-1">æ¨™æº–ãƒ¬ãƒ™ãƒ«ã®ç·´ç¿’å•é¡Œã€‚é€Ÿã•ã¨æ­£ç¢ºã•ã‚’ãƒãƒ©ãƒ³ã‚¹ã‚ˆãé›ãˆã‚‰ã‚Œã¾ã™ã€‚</p>
          <a href="{{ url_for('training', problem='normal') }}" class="btn btn-primary btn-lg mt-auto">ç·´ç¿’é–‹å§‹</a>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm rounded-4 border-0 h-100">
        <div class="card-body d-flex flex-column">
          <h4 class="card-title mb-3 text-danger">ğŸ”´ Hardãƒ¬ãƒ™ãƒ«</h4>
          <p class="card-text flex-grow-1">é›£æ˜“åº¦ã®é«˜ã„å•é¡Œã§é›†ä¸­åŠ›ã‚’é›ãˆã€ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¹ã‚­ãƒ«ã‚’å¤§å¹…ã‚¢ãƒƒãƒ—ï¼</p>
          <a href="{{ url_for('training', problem='hard') }}" class="btn btn-danger btn-lg mt-auto">ç·´ç¿’é–‹å§‹</a>
        </div>
      </div>
    </div>

  </div>

  <!-- ãã®ä»–ã®ãŠçŸ¥ã‚‰ã›ãƒ»Tips -->
  <div class="row mt-5 justify-content-center">
    <div class="col-md-8">
      <div class="alert alert-info rounded-4 shadow-sm" role="alert">
        <h5 class="alert-heading">ğŸ’¡ Tips</h5>
        <p>æ¯æ—¥ã®ç¶™ç¶šãŒä¸Šé”ã®éµã§ã™ã€‚æ™‚é–“ã‚’æ±ºã‚ã¦çŸ­æ™‚é–“ã§ã‚‚è‰¯ã„ã®ã§ã€ã‚³ãƒ„ã‚³ãƒ„ç¶šã‘ã¾ã—ã‚‡ã†ï¼</p>
      </div>
    </div>
  </div>

</div>



<script>
  // ç›®æ¨™è¨­å®šå‡¦ç†
  const saveBtn = document.getElementById("save-Btn");
  const trainingInput = document.getElementById("training-input");
  const remainingDisplay = document.getElementById("remaining-Display");
  saveBtn.addEventListener("click", function () {
    const targetCount = parseInt(trainingInput.value);
    if (isNaN(targetCount) || targetCount <= 0) {
      alert("æœ‰åŠ¹ãªæ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
      return;
    }

    localStorage.setItem("targetCount", targetCount);
    localStorage.setItem("remainingCount", targetCount);
    
    if (remainingDisplay) remainingDisplay.textContent = targetCount;

    saveBtn.disabled = true;
    localStorage.setItem("saveBtnDisabled", "true");
  });

  // ãƒªã‚»ãƒƒãƒˆå‡¦ç†
  const resetBtn = document.getElementById("reset-Btn");
  resetBtn.addEventListener("click", () => {
    saveBtn.disabled = false;
    localStorage.removeItem("targetCount");
    localStorage.removeItem("remainingCount");
    localStorage.removeItem("saveBtnDisabled");
    
    trainingInput.value = 0;
    remainingDisplay.textContent = "--";

    progressBar.style.width = "0%";
    progressBar.setAttribute("aria-valuenow", 0);
    progressBar.textContent = "0%";


  });

  // å†èª­ã¿è¾¼ã¿å‡¦ç†
  document.addEventListener("DOMContentLoaded", () => {
    const remaining = localStorage.getItem("remainingCount");
    remainingDisplay.textContent = remaining !== null ? remaining : "--";

    const target = localStorage.getItem("targetCount");
    if (target !== null) {
      trainingInput.value = target;
    }

    saveBtn.disabled = (localStorage.getItem("saveBtnDisabled") === "true"); 
  });

  // é€²æ—ãƒãƒ¼æ›´æ–°
  const progressBar = document.querySelector(".progress-bar");
  function updateProgressBar(remaining, target) {
    const percent = 100 * (target - remaining) / target;
    if (progressBar) {
      progressBar.style.width = `${percent}%`;
      progressBar.setAttribute("aria-valuenow", percent);
      progressBar.textContent = `${Math.round(percent)}%`;
    }

    const progressText = document.querySelector(".text-muted");
    if (progressText) {
      progressText.textContent = `ç›®æ¨™é”æˆã¾ã§ã‚ã¨ ${remaining} å›`;
    }
  }

  // æœ€åˆã«æ®‹ã‚Šå›æ•°ãƒ»é€²æ—ã‚’è¡¨ç¤º
  window.addEventListener("DOMContentLoaded", () => {
    const remaining = localStorage.getItem("remainingCount");
    const target = localStorage.getItem("targetCount");

    if (remaining !== null && target !== null) {
      if (remainingDisplay) remainingDisplay.textContent = remaining;
      updateProgressBar(remaining, target);
    }
  });


</script>


<!-- <script src="/static/main.js"></script> -->








{% endblock %}
